{# @var product \Generated\Shared\Transfer\BuyBoxProductTransfer #}

{% extends template('widget') %}

{% define data = {
    locale: app.locale | slice(0, 2),
    products: _widget.products,
    productView: _widget.productView,
    isPriceVisible: data.isPriceVisible | default(false)
} %}

{% block template %}
    {% if data.products %}
        <h6 class="spacing-y">{{ 'buy_box.sold_by' | trans }}</h6>

        {% for product in data.products %}
            {% block buyBoxProduct %}
                {% set merchant = product.merchant %}

                {% include molecule('buy-box-item', 'BuyBox') with {
                    class: 'spacing-y',
                    data: {
                        isChecked: data.productView.productOfferReference is same as(product.productOfferReference),
                        radioGroupName: 'product_offer_reference',
                        productOfferReference: product.productOfferReference | default,
                        merchantName: merchant.name | default,
                        merchantUrl: merchant.merchantUrl | default,
                        merchantReference: merchant.merchantReference | default(null),
                        price: product.price | default(null),
                        currencyIsoCode: product.price.currency.code | default(null),
                        isRadioButtonVisible: data.products | length > 1,
                        product: product,
                    },
                } only %}
            {% endblock %}

            {% block buyBoxProductSeparator %}
                {% if not loop.last %}
                    <hr>
                {% endif %}
            {% endblock %}
        {% endfor %}
    {% endif %}
{% endblock %}
